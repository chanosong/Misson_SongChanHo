# 2Week_SongChanHo.md

## Title: [2Week] 송찬호

### 미션 요구사항 분석 & 체크리스트

---

- [x] 호감표시 할 때 예외처리 케이스 3가지 추가 처리 (필수)

  - [x] 중복 호감 표시 예외처리
    - [x] 이미 호감등록이 되어있는 관계인지 확인하는 함수
    - [x] 이미 등록되어있는 관계라면 Fail 처리
    - [x] 테스팅 함수 작성
  - [x] 11명 이상 호감 표시 불가
    - [x] 현재 사용자가 호감등록 한 회원 수 반환 방법 강구
    - [x] 현재 등록된 관계가 10개라면 더 이상 추가 못하게 Fail 처리
    - [x] 테스팅 함수 작성
    - [x] 호감등록 최대치 변수화 후 분리
  - [x] 같은 대상이어도 호감 사유가 다르다면 호감 등록 가능
    - [x] 확장성을 위해 기존의 fromInstaMemberId와 toInstaMemberId로 조회하는 함수 리턴 타입 변경
    - [x] 동일 인물 예외처리에 코드가 같은 경우와 다른 경우로 분기 설정
    - [x] 편의를 위한 AttractiveTypeCode enum class 작성
    - [x] 테스팅 함수 작성

- [x] 네이버 소셜 로그인 기능 (선택)
  - [x] 네이버 API 이용을 위한 어플리케이션 등록
  - [x] Client ID, Secret 등록
  - [x] 네이버 회원가입 기능 구현
  - [x] 네이버 ID 파싱 후 적용

### 2주차 미션 요약

---

**[접근 방법]**

 - 중복 호감등록인지 판단
   - 최초에는 fromInstaMember와 toInstaMember를 인자로 받아 관계가 존재하는지 판단 함수 작성
   - 중복 호감이지만 사유가 다른 경유를 위해 해당 방식은 무효하다 생각하여 함수 삭제
   - 대신 from~, to~ 의 관계를 같는 likeablePerson 객체를 Optional로 받아와 isPresent()로 기존에 존재하였는가 확인
 - 10명 초과 등록 제한 기능
   - 기존에는 개수를 반환하는 함수를 따로 구현하였으나 재사용성이 떨어진다고 판단
   - findByFromInstaMemberId 함수를 재활용하여 해당 함수의 리턴 리스트의 사이즈를 활용
 - 중복 호감이지만 사유가 다른 경우 허용 및 업데이트
   - 해당 주차 첫 번째 기능인 중복 판단 이후 attractiveTypeCode 끼리 비교하여 다르다면 업데이트
   - save()를 활용한 업데이트가 아닌 JPA 변경 감지 기능을 활용
   - 페이지에서 사유를 더 편하게 표현하기 위해 enum 클래스 사용
 - Naver 로그인 기능
   - 네이버 로그인 API를 사용하기 위해 네이버 디벨로퍼스 가입 후 설정
   - 네이버는 oAuth2에 provider로 기본 설정되어있지 않기에 카카오와 같이 수동 설정
   - 네이버의 경우 다른 로그인 방식과 형태가 달라 OAuth2User를 Map을 통해 파싱하여 id값만 뽑아옴 

**[특이사항]**

 - 기능들이 10회 초과 시 불가 ~, 호감 사유 업데이트와 같이 반복적으로 이루어져야하는 것이 많았기에 이를 편리하게 하기 위해 반복문을 활용한 테스팅을 진행하였다.
 - 지난 주차와 같이 소셜 로그인 기능 구현 시 registration 설정에서 자꾸 오류가 난다. 재차 확인 필요.
 - 네이버의 경우 다른 소셜 로그인과 OAuth2User 반환 형태가 달라서 해결하기 위해 처음에는 JSONParser를 사용하여 했으나 기존에 만들어뒀던 getAttributes() 함수를 뒤늦게 확인하고 사용하였다. 미리 만든 함수에 대한 인지 및 파악을 항상 해야한다.


  **[Refactoring]**

    ## 진행 중